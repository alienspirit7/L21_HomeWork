2025-11-30 00:09:34,987 - __main__ - INFO - ======================================================================
2025-11-30 00:09:34,987 - __main__ - INFO - ============ IRIS CLASSIFICATION: NAIVE BAYES COMPARISON =============
2025-11-30 00:09:34,987 - __main__ - INFO - ======================================================================
2025-11-30 00:09:34,987 - __main__ - INFO - Comparing Manual NumPy vs Sklearn Implementations

2025-11-30 00:09:34,987 - __main__ - INFO - STEP 1: Loading and Splitting Data
2025-11-30 00:09:34,987 - __main__ - INFO - ----------------------------------------------------------------------
2025-11-30 00:09:34,987 - data_loader - INFO - Loading Iris dataset from: Iris.csv
2025-11-30 00:09:34,990 - data_loader - INFO - Dataset shape: (150, 6)
2025-11-30 00:09:34,990 - data_loader - INFO - Columns: ['Id', 'SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm', 'Species']
2025-11-30 00:09:34,991 - data_loader - INFO - Features shape: (150, 4)
2025-11-30 00:09:34,991 - data_loader - INFO - Feature names: ['SepalLength', 'SepalWidth', 'PetalLength', 'PetalWidth']
2025-11-30 00:09:34,991 - data_loader - INFO - Classes: ['Iris-setosa', 'Iris-versicolor', 'Iris-virginica']
2025-11-30 00:09:34,991 - data_loader - INFO - Class distribution: [50 50 50]
2025-11-30 00:09:34,991 - data_loader - INFO - 
============================================================
2025-11-30 00:09:34,991 - data_loader - INFO - Train/Test Split (test_size=0.25):
2025-11-30 00:09:34,991 - data_loader - INFO -   Training set: 114 samples (76.0%)
2025-11-30 00:09:34,991 - data_loader - INFO -   Test set:     36 samples (24.0%)
2025-11-30 00:09:34,991 - data_loader - INFO -   Train class distribution: [38 38 38]
2025-11-30 00:09:34,991 - data_loader - INFO -   Test class distribution:  [12 12 12]
2025-11-30 00:09:34,991 - data_loader - INFO - ============================================================

2025-11-30 00:09:34,991 - __main__ - INFO - 
STEP 2: Training Manual NumPy Implementation
2025-11-30 00:09:34,991 - __main__ - INFO - ----------------------------------------------------------------------
2025-11-30 00:09:34,991 - naive_bayes_numpy - INFO - ============================================================
2025-11-30 00:09:34,991 - naive_bayes_numpy - INFO - Training Manual NumPy Naive Bayes Classifier
2025-11-30 00:09:34,991 - naive_bayes_numpy - INFO - ============================================================
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO - 
Class 0:
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Samples: 38
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Prior P(y=0): 0.3333
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Feature means: [5.02105263 3.42894737 1.46578947 0.25263158]
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Feature variances: [0.13955679 0.14679363 0.03330332 0.01196676]
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO - 
Class 1:
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Samples: 38
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Prior P(y=1): 0.3333
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Feature means: [5.95       2.8        4.27631579 1.33947368]
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Feature variances: [0.24039474 0.08263158 0.21759695 0.04028393]
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO - 
Class 2:
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Samples: 38
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Prior P(y=2): 0.3333
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Feature means: [6.54736842 2.98157895 5.48684211 2.03421053]
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO -   Feature variances: [0.37354571 0.09097645 0.25166898 0.07488227]
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO - 
============================================================
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO - Training Complete!
2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO - ============================================================

2025-11-30 00:09:34,992 - naive_bayes_numpy - INFO - Generating feature distribution histograms...
2025-11-30 00:09:35,907 - naive_bayes_numpy - INFO - Saved feature distribution plot to: logs/numpy_feature_distributions.png
2025-11-30 00:09:35,907 - __main__ - INFO - 
STEP 3: Testing NumPy Implementation
2025-11-30 00:09:35,907 - __main__ - INFO - ----------------------------------------------------------------------
2025-11-30 00:09:35,909 - __main__ - INFO - NumPy Model Test Accuracy: 0.9444 (94.44%)
2025-11-30 00:09:35,909 - __main__ - INFO - Correct predictions: 34/36

2025-11-30 00:09:35,909 - __main__ - INFO - 
STEP 4: Training Sklearn Implementation
2025-11-30 00:09:35,909 - __main__ - INFO - ----------------------------------------------------------------------
2025-11-30 00:09:35,909 - naive_bayes_sklearn - INFO - ============================================================
2025-11-30 00:09:35,909 - naive_bayes_sklearn - INFO - Training Sklearn Naive Bayes Classifier
2025-11-30 00:09:35,909 - naive_bayes_sklearn - INFO - ============================================================
2025-11-30 00:09:35,909 - naive_bayes_sklearn - INFO - 
Classes: [0 1 2]
2025-11-30 00:09:35,909 - naive_bayes_sklearn - INFO - Number of features: 4
2025-11-30 00:09:35,909 - naive_bayes_sklearn - INFO - 
Class 0:
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Prior P(y=0): 0.3333
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Feature means (θ): [5.02105263 3.42894737 1.46578947 0.25263158]
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Feature variance (σ²): [0.13955679 0.14679363 0.03330333 0.01196676]
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO - 
Class 1:
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Prior P(y=1): 0.3333
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Feature means (θ): [5.95       2.8        4.27631579 1.33947368]
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Feature variance (σ²): [0.24039474 0.08263158 0.21759696 0.04028394]
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO - 
Class 2:
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Prior P(y=2): 0.3333
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Feature means (θ): [6.54736842 2.98157895 5.48684211 2.03421053]
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO -   Feature variance (σ²): [0.37354571 0.09097646 0.25166898 0.07488227]
2025-11-30 00:09:35,910 - naive_bayes_sklearn - INFO - 
============================================================
2025-11-30 00:09:35,911 - naive_bayes_sklearn - INFO - Training Complete!
2025-11-30 00:09:35,911 - naive_bayes_sklearn - INFO - ============================================================

2025-11-30 00:09:35,911 - __main__ - INFO - 
STEP 5: Testing Sklearn Implementation
2025-11-30 00:09:35,911 - __main__ - INFO - ----------------------------------------------------------------------
2025-11-30 00:09:35,911 - __main__ - INFO - Sklearn Model Test Accuracy: 0.9444 (94.44%)
2025-11-30 00:09:35,911 - __main__ - INFO - Correct predictions: 34/36

2025-11-30 00:09:35,912 - naive_bayes_sklearn - INFO - ============================================================
2025-11-30 00:09:35,912 - naive_bayes_sklearn - INFO - Sklearn Model - Detailed Evaluation
2025-11-30 00:09:35,912 - naive_bayes_sklearn - INFO - ============================================================
2025-11-30 00:09:35,912 - naive_bayes_sklearn - INFO - 
Confusion Matrix:
[[12  0  0]
 [ 0 11  1]
 [ 0  1 11]]
2025-11-30 00:09:35,914 - naive_bayes_sklearn - INFO - 
Classification Report:
              precision    recall  f1-score   support

      Setosa       1.00      1.00      1.00        12
  Versicolor       0.92      0.92      0.92        12
   Virginica       0.92      0.92      0.92        12

    accuracy                           0.94        36
   macro avg       0.94      0.94      0.94        36
weighted avg       0.94      0.94      0.94        36

2025-11-30 00:09:35,914 - naive_bayes_sklearn - INFO - ============================================================

2025-11-30 00:09:35,914 - __main__ - INFO - 
STEP 6: Comparing Implementations
2025-11-30 00:09:35,914 - __main__ - INFO - ----------------------------------------------------------------------
2025-11-30 00:09:35,914 - comparison - INFO - ============================================================
2025-11-30 00:09:35,914 - comparison - INFO - COMPARISON: NumPy vs Sklearn Implementations
2025-11-30 00:09:35,914 - comparison - INFO - ============================================================
2025-11-30 00:09:35,917 - comparison - INFO - 
Accuracy Comparison:
2025-11-30 00:09:35,917 - comparison - INFO -   NumPy Implementation:  0.9444 (94.44%)
2025-11-30 00:09:35,917 - comparison - INFO -   Sklearn Implementation: 0.9444 (94.44%)
2025-11-30 00:09:35,917 - comparison - INFO -   Difference: 0.000000
2025-11-30 00:09:35,918 - comparison - INFO - 
Detailed Metrics (Weighted Average):
2025-11-30 00:09:35,918 - comparison - INFO -   NumPy - Precision: 0.9444, Recall: 0.9444, F1: 0.9444
2025-11-30 00:09:35,918 - comparison - INFO -   Sklearn - Precision: 0.9444, Recall: 0.9444, F1: 0.9444
2025-11-30 00:09:35,918 - comparison - INFO - 
Prediction Agreement: 1.0000 (100.00%)
2025-11-30 00:09:35,918 - comparison - INFO - Perfect agreement! All predictions match.
2025-11-30 00:09:35,918 - comparison - INFO - ============================================================

2025-11-30 00:09:35,918 - __main__ - INFO - 
STEP 7: Generating Comparison Visualizations
2025-11-30 00:09:35,919 - __main__ - INFO - ----------------------------------------------------------------------
2025-11-30 00:09:35,919 - comparison - INFO - Generating confusion matrices...
2025-11-30 00:09:36,039 - comparison - INFO - Saved confusion matrices to: logs/confusion_matrices.png
2025-11-30 00:09:36,039 - __main__ - INFO - 
STEP 8: Analysis and Explanation
2025-11-30 00:09:36,039 - __main__ - INFO - ----------------------------------------------------------------------
2025-11-30 00:09:36,039 - comparison - INFO - ============================================================
2025-11-30 00:09:36,039 - comparison - INFO - ANALYSIS: Why Results Might Differ
2025-11-30 00:09:36,039 - comparison - INFO - ============================================================
2025-11-30 00:09:36,039 - comparison - INFO - 
    Expected Outcome: Both implementations should produce VERY SIMILAR or IDENTICAL results.
    
    Reasons for Small Differences (if any):
    
    1. NUMERICAL PRECISION
       - NumPy implementation uses float64 by default
       - Sklearn may use different precision in internal calculations
       - Log-probability calculations can accumulate small rounding errors
    
    2. VARIANCE ESTIMATION
       - NumPy: Uses np.var() which divides by N (biased estimator)
       - Sklearn: May use sample variance (N-1) for better generalization
       - This affects the Gaussian likelihood calculations
    
    3. REGULARIZATION
       - Sklearn adds small epsilon (1e-9) to variance by default
       - Prevents division by zero for features with low variance
       - Our NumPy implementation also adds epsilon for stability
    
    4. PROBABILITY CALCULATIONS
       - NumPy: We use log probabilities to avoid underflow
       - Sklearn: Also uses log probabilities internally
       - Minor differences in log computation can propagate
    
    Expected Results:
    - Accuracy should be within 0.01-0.02 (1-2%) for both methods
       - Iris is a well-separated dataset, typically >95% accuracy
    - Most predictions should agree (>95% agreement)
    - Confusion matrices should be nearly identical
    - Any differences are likely in borderline cases near decision boundaries
    
    If results are SIGNIFICANTLY different (>5% accuracy difference):
    - Check for implementation bugs in NumPy version
    - Verify same train/test split is used
    - Ensure feature scaling is consistent
    
2025-11-30 00:09:36,043 - comparison - INFO - ============================================================

2025-11-30 00:09:36,043 - __main__ - INFO - ======================================================================
2025-11-30 00:09:36,043 - __main__ - INFO - ========================= EXECUTION COMPLETE =========================
2025-11-30 00:09:36,043 - __main__ - INFO - ======================================================================
2025-11-30 00:09:36,043 - __main__ - INFO - 
Results Summary:
2025-11-30 00:09:36,043 - __main__ - INFO -   NumPy Accuracy:   94.44%
2025-11-30 00:09:36,043 - __main__ - INFO -   Sklearn Accuracy: 94.44%
2025-11-30 00:09:36,043 - __main__ - INFO -   Agreement Rate:   100.00%
2025-11-30 00:09:36,043 - __main__ - INFO - 
Generated Files:
2025-11-30 00:09:36,043 - __main__ - INFO -   - logs/iris_classification.log
2025-11-30 00:09:36,043 - __main__ - INFO -   - logs/numpy_feature_distributions.png
2025-11-30 00:09:36,043 - __main__ - INFO -   - logs/confusion_matrices.png
2025-11-30 00:09:36,043 - __main__ - INFO - ======================================================================

